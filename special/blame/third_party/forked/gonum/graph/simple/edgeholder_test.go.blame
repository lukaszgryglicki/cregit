0000000000000000000000000000000000000000;;	package simple
3a89bcdd9902c0469cca94315a1373d1dd23d336;;	
0000000000000000000000000000000000000000;;	import (
0000000000000000000000000000000000000000;;		"reflect"
0000000000000000000000000000000000000000;;		"sort"
0000000000000000000000000000000000000000;;		"testing"
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		"k8s.io/kubernetes/third_party/forked/gonum/graph"
0000000000000000000000000000000000000000;;	)
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	func TestEdgeHolder(t *testing.T) {
0000000000000000000000000000000000000000;;		holder := edgeHolder(&sliceEdgeHolder{self: 1})
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		// Empty tests
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 0 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 0")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(2); ok || n != nil {
0000000000000000000000000000000000000000;;			t.Errorf("expected nil,false")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		holder.Visit(func(_ int, _ graph.Edge) { t.Errorf("unexpected call to visitor") })
0000000000000000000000000000000000000000;;		holder = holder.Delete(2)
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		// Insert an edge to ourselves
0000000000000000000000000000000000000000;;		holder = holder.Set(1, Edge{F: Node(1), T: Node(1)})
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 1 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 1")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(1); !ok || n == nil || n.From().ID() != 1 || n.To().ID() != 1 {
0000000000000000000000000000000000000000;;			t.Errorf("expected edge to ourselves, got %#v", n)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		neighbors := []int{}
0000000000000000000000000000000000000000;;		holder.Visit(func(neighbor int, _ graph.Edge) { neighbors = append(neighbors, neighbor) })
0000000000000000000000000000000000000000;;		if !reflect.DeepEqual(neighbors, []int{1}) {
0000000000000000000000000000000000000000;;			t.Errorf("expected a single visit to ourselves, got %v", neighbors)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		// Insert edges from us to other nodes
0000000000000000000000000000000000000000;;		holder = holder.Set(2, Edge{F: Node(1), T: Node(2)})
0000000000000000000000000000000000000000;;		holder = holder.Set(3, Edge{F: Node(1), T: Node(3)})
0000000000000000000000000000000000000000;;		holder = holder.Set(4, Edge{F: Node(1), T: Node(4)})
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 4 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 4")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(2); !ok || n == nil || n.From().ID() != 1 || n.To().ID() != 2 {
0000000000000000000000000000000000000000;;			t.Errorf("expected edge from us to another node, got %#v", n)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		neighbors = []int{}
0000000000000000000000000000000000000000;;		holder.Visit(func(neighbor int, _ graph.Edge) { neighbors = append(neighbors, neighbor) })
0000000000000000000000000000000000000000;;		if !reflect.DeepEqual(neighbors, []int{1, 2, 3, 4}) {
0000000000000000000000000000000000000000;;			t.Errorf("expected a single visit to ourselves, got %v", neighbors)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		// Insert edges to us to other nodes
0000000000000000000000000000000000000000;;		holder = holder.Set(2, Edge{F: Node(2), T: Node(1)})
0000000000000000000000000000000000000000;;		holder = holder.Set(3, Edge{F: Node(3), T: Node(1)})
0000000000000000000000000000000000000000;;		holder = holder.Set(4, Edge{F: Node(4), T: Node(1)})
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 4 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 4")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(2); !ok || n == nil || n.From().ID() != 2 || n.To().ID() != 1 {
0000000000000000000000000000000000000000;;			t.Errorf("expected reversed edge, got %#v", n)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		neighbors = []int{}
0000000000000000000000000000000000000000;;		holder.Visit(func(neighbor int, _ graph.Edge) { neighbors = append(neighbors, neighbor) })
0000000000000000000000000000000000000000;;		if !reflect.DeepEqual(neighbors, []int{1, 2, 3, 4}) {
0000000000000000000000000000000000000000;;			t.Errorf("expected a single visit to ourselves, got %v", neighbors)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		if _, ok := holder.(*sliceEdgeHolder); !ok {
0000000000000000000000000000000000000000;;			t.Errorf("expected slice edge holder")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		// Make the transition to a map
0000000000000000000000000000000000000000;;		holder = holder.Set(5, Edge{F: Node(5), T: Node(1)})
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		if _, ok := holder.(mapEdgeHolder); !ok {
0000000000000000000000000000000000000000;;			t.Errorf("expected map edge holder")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 5 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 5")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(2); !ok || n == nil || n.From().ID() != 2 || n.To().ID() != 1 {
0000000000000000000000000000000000000000;;			t.Errorf("expected old edges, got %#v", n)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		if n, ok := holder.Get(5); !ok || n == nil || n.From().ID() != 5 || n.To().ID() != 1 {
0000000000000000000000000000000000000000;;			t.Errorf("expected new edge, got %#v", n)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		neighbors = []int{}
0000000000000000000000000000000000000000;;		holder.Visit(func(neighbor int, _ graph.Edge) { neighbors = append(neighbors, neighbor) })
0000000000000000000000000000000000000000;;		sort.Ints(neighbors) // sort, map order is random
0000000000000000000000000000000000000000;;		if !reflect.DeepEqual(neighbors, []int{1, 2, 3, 4, 5}) {
0000000000000000000000000000000000000000;;			t.Errorf("expected 1,2,3,4,5, got %v", neighbors)
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		holder = holder.Delete(1)
0000000000000000000000000000000000000000;;		holder = holder.Delete(2)
0000000000000000000000000000000000000000;;		holder = holder.Delete(3)
0000000000000000000000000000000000000000;;		holder = holder.Delete(4)
0000000000000000000000000000000000000000;;		holder = holder.Delete(5)
0000000000000000000000000000000000000000;;		holder = holder.Delete(6)
0000000000000000000000000000000000000000;;		if len := holder.Len(); len != 0 {
0000000000000000000000000000000000000000;;			t.Errorf("expected 0")
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	}
