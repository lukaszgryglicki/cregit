0000000000000000000000000000000000000000;;	#!/bin/bash
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	# Copyright 2017 The Kubernetes Authors.
0000000000000000000000000000000000000000;;	#
0000000000000000000000000000000000000000;;	# Licensed under the Apache License, Version 2.0 (the "License");
0000000000000000000000000000000000000000;;	# you may not use this file except in compliance with the License.
0000000000000000000000000000000000000000;;	# You may obtain a copy of the License at
0000000000000000000000000000000000000000;;	#
0000000000000000000000000000000000000000;;	#     http://www.apache.org/licenses/LICENSE-2.0
0000000000000000000000000000000000000000;;	#
0000000000000000000000000000000000000000;;	# Unless required by applicable law or agreed to in writing, software
0000000000000000000000000000000000000000;;	# distributed under the License is distributed on an "AS IS" BASIS,
0000000000000000000000000000000000000000;;	# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
0000000000000000000000000000000000000000;;	# See the License for the specific language governing permissions and
0000000000000000000000000000000000000000;;	# limitations under the License.
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	KUBECTL_FILES="pkg/kubectl/cmd/*.go pkg/kubectl/cmd/*/*.go"
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	generate_pot="false"
0000000000000000000000000000000000000000;;	generate_mo="false"
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	while getopts "hf:xg" opt; do
0000000000000000000000000000000000000000;;	  case $opt in
0000000000000000000000000000000000000000;;	    h)
0000000000000000000000000000000000000000;;	      echo "$0 [-f files] [-x] [-g]"
0000000000000000000000000000000000000000;;	      echo " -f <file-path>: Files to process"
0000000000000000000000000000000000000000;;	      echo " -x extract strings to a POT file"
0000000000000000000000000000000000000000;;	      echo " -g sort .po files and generate .mo files"
0000000000000000000000000000000000000000;;	      exit 0
0000000000000000000000000000000000000000;;	      ;;
0000000000000000000000000000000000000000;;	    f)
0000000000000000000000000000000000000000;;	      KUBECTL_FILES="${OPTARG}"
0000000000000000000000000000000000000000;;	      ;;
0000000000000000000000000000000000000000;;	    x)
0000000000000000000000000000000000000000;;	      generate_pot="true"
0000000000000000000000000000000000000000;;	      ;;
0000000000000000000000000000000000000000;;	    g)
0000000000000000000000000000000000000000;;	      generate_mo="true"
0000000000000000000000000000000000000000;;	      ;;
0000000000000000000000000000000000000000;;	    \?)
0000000000000000000000000000000000000000;;	      echo "[-f <files>] -x -g" >&2
0000000000000000000000000000000000000000;;	      exit 1
0000000000000000000000000000000000000000;;	      ;;
0000000000000000000000000000000000000000;;	  esac
0000000000000000000000000000000000000000;;	done
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	if ! which go-xgettext > /dev/null; then
0000000000000000000000000000000000000000;;	  echo 'Can not find go-xgettext, install with:'
0000000000000000000000000000000000000000;;	  echo 'go get github.com/gosexy/gettext/go-xgettext'
0000000000000000000000000000000000000000;;	  exit 1
0000000000000000000000000000000000000000;;	fi
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	if ! which msgfmt > /dev/null; then
0000000000000000000000000000000000000000;;	  echo 'Can not find msgfmt, install with:'
0000000000000000000000000000000000000000;;	  echo 'apt-get install gettext'
0000000000000000000000000000000000000000;;	  exit 1
0000000000000000000000000000000000000000;;	fi
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	if [[ "${generate_pot}" == "true" ]]; then
0000000000000000000000000000000000000000;;	  echo "Extracting strings to POT"
0000000000000000000000000000000000000000;;	  go-xgettext -k=i18n.T ${KUBECTL_FILES} > tmp.pot
0000000000000000000000000000000000000000;;	  perl -pi -e 's/CHARSET/UTF-8/' tmp.pot
0000000000000000000000000000000000000000;;	  perl -pi -e 's/\\\(/\\\\\(/g' tmp.pot
0000000000000000000000000000000000000000;;	  perl -pi -e 's/\\\)/\\\\\)/g' tmp.pot
0000000000000000000000000000000000000000;;	  if msgcat -s tmp.pot > /tmp/template.pot; then
0000000000000000000000000000000000000000;;	    mv /tmp/template.pot translations/kubectl/template.pot
0000000000000000000000000000000000000000;;	    rm tmp.pot
0000000000000000000000000000000000000000;;	  else
0000000000000000000000000000000000000000;;	    echo "Failed to update template.pot"
0000000000000000000000000000000000000000;;	    exit 1
0000000000000000000000000000000000000000;;	  fi
0000000000000000000000000000000000000000;;	fi
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	if [[ "${generate_mo}" == "true" ]]; then
0000000000000000000000000000000000000000;;	  echo "Generating .po and .mo files"
0000000000000000000000000000000000000000;;	  for x in translations/*/*/*/*.po; do
0000000000000000000000000000000000000000;;	    msgcat -s $x > tmp.po
0000000000000000000000000000000000000000;;	    mv tmp.po $x
0000000000000000000000000000000000000000;;	    echo "generating .mo file for: $x"
0000000000000000000000000000000000000000;;	    msgfmt $x -o "$(dirname $x)/$(basename $x .po).mo"
0000000000000000000000000000000000000000;;	  done
0000000000000000000000000000000000000000;;	fi
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	./hack/generate-bindata.sh
