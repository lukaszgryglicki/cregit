0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: Secret
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: registry-tls-data
0000000000000000000000000000000000000000;;	type: Opaque
0000000000000000000000000000000000000000;;	data:
0000000000000000000000000000000000000000;;	  tls.crt: {{ tlscert }}
0000000000000000000000000000000000000000;;	  tls.key: {{ tlskey }}
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: Secret
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: registry-auth-data
0000000000000000000000000000000000000000;;	type: Opaque
0000000000000000000000000000000000000000;;	data:
0000000000000000000000000000000000000000;;	  htpasswd: {{ htpasswd }}
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: ReplicationController
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: kube-registry-v0
0000000000000000000000000000000000000000;;	  labels:
0000000000000000000000000000000000000000;;	    k8s-app: kube-registry
0000000000000000000000000000000000000000;;	    version: v0
0000000000000000000000000000000000000000;;	    kubernetes.io/cluster-service: "true"
0000000000000000000000000000000000000000;;	spec:
0000000000000000000000000000000000000000;;	  replicas: 1
0000000000000000000000000000000000000000;;	  selector:
0000000000000000000000000000000000000000;;	    k8s-app: kube-registry
0000000000000000000000000000000000000000;;	    version: v0
0000000000000000000000000000000000000000;;	  template:
0000000000000000000000000000000000000000;;	    metadata:
0000000000000000000000000000000000000000;;	      labels:
0000000000000000000000000000000000000000;;	        k8s-app: kube-registry
0000000000000000000000000000000000000000;;	        version: v0
0000000000000000000000000000000000000000;;	        kubernetes.io/cluster-service: "true"
0000000000000000000000000000000000000000;;	    spec:
0000000000000000000000000000000000000000;;	      containers:
0000000000000000000000000000000000000000;;	      - name: registry
0000000000000000000000000000000000000000;;	        image: registry:2
0000000000000000000000000000000000000000;;	        resources:
0000000000000000000000000000000000000000;;	          # keep request = limit to keep this container in guaranteed class
0000000000000000000000000000000000000000;;	          limits:
0000000000000000000000000000000000000000;;	            cpu: 100m
0000000000000000000000000000000000000000;;	            memory: 100Mi
0000000000000000000000000000000000000000;;	          requests:
0000000000000000000000000000000000000000;;	            cpu: 100m
0000000000000000000000000000000000000000;;	            memory: 100Mi
0000000000000000000000000000000000000000;;	        env:
0000000000000000000000000000000000000000;;	        - name: REGISTRY_HTTP_ADDR
0000000000000000000000000000000000000000;;	          value: :5000
0000000000000000000000000000000000000000;;	        - name: REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY
0000000000000000000000000000000000000000;;	          value: /var/lib/registry
0000000000000000000000000000000000000000;;	        - name: REGISTRY_AUTH_HTPASSWD_REALM
0000000000000000000000000000000000000000;;	          value: basic_realm
0000000000000000000000000000000000000000;;	        - name: REGISTRY_AUTH_HTPASSWD_PATH
0000000000000000000000000000000000000000;;	          value: /auth/htpasswd
0000000000000000000000000000000000000000;;	        volumeMounts:
0000000000000000000000000000000000000000;;	        - name: image-store
0000000000000000000000000000000000000000;;	          mountPath: /var/lib/registry
0000000000000000000000000000000000000000;;	        - name: auth-dir
0000000000000000000000000000000000000000;;	          mountPath: /auth
0000000000000000000000000000000000000000;;	        ports:
0000000000000000000000000000000000000000;;	        - containerPort: 5000
0000000000000000000000000000000000000000;;	          name: registry
0000000000000000000000000000000000000000;;	          protocol: TCP
0000000000000000000000000000000000000000;;	      volumes:
0000000000000000000000000000000000000000;;	      - name: image-store
0000000000000000000000000000000000000000;;	        hostPath:
0000000000000000000000000000000000000000;;	          path: /srv/registry
0000000000000000000000000000000000000000;;	      - name: auth-dir
0000000000000000000000000000000000000000;;	        secret:
0000000000000000000000000000000000000000;;	          secretName: registry-auth-data
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: Service
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: kube-registry
0000000000000000000000000000000000000000;;	  labels:
0000000000000000000000000000000000000000;;	    k8s-app: kube-registry
0000000000000000000000000000000000000000;;	    kubernetes.io/cluster-service: "true"
0000000000000000000000000000000000000000;;	    kubernetes.io/name: "KubeRegistry"
0000000000000000000000000000000000000000;;	spec:
0000000000000000000000000000000000000000;;	  selector:
0000000000000000000000000000000000000000;;	    k8s-app: kube-registry
0000000000000000000000000000000000000000;;	  type: LoadBalancer
0000000000000000000000000000000000000000;;	  ports:
0000000000000000000000000000000000000000;;	  - name: registry
0000000000000000000000000000000000000000;;	    port: 5000
0000000000000000000000000000000000000000;;	    protocol: TCP
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: Secret
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: registry-access
0000000000000000000000000000000000000000;;	data:
0000000000000000000000000000000000000000;;	  .dockercfg: {{ dockercfg }}
0000000000000000000000000000000000000000;;	type: kubernetes.io/dockercfg
0000000000000000000000000000000000000000;;	{%- if ingress %}
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: extensions/v1beta1
0000000000000000000000000000000000000000;;	kind: Ingress
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: registry-ing
0000000000000000000000000000000000000000;;	spec:
0000000000000000000000000000000000000000;;	  tls:
0000000000000000000000000000000000000000;;	  - hosts:
0000000000000000000000000000000000000000;;	    - {{ domain }}
0000000000000000000000000000000000000000;;	    secretName: registry-tls-data
0000000000000000000000000000000000000000;;	  rules:
0000000000000000000000000000000000000000;;	  - host: {{ domain }}
0000000000000000000000000000000000000000;;	    http:
0000000000000000000000000000000000000000;;	      paths:
0000000000000000000000000000000000000000;;	      - backend:
0000000000000000000000000000000000000000;;	          serviceName: kube-registry
0000000000000000000000000000000000000000;;	          servicePort: 5000
0000000000000000000000000000000000000000;;	        path: /
0000000000000000000000000000000000000000;;	{% endif %}
