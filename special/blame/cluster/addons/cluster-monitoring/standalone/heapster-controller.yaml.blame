0000000000000000000000000000000000000000;;	{% set base_metrics_memory = "140Mi" -%}
0000000000000000000000000000000000000000;;	{% set metrics_memory_per_node = 4 -%}
0000000000000000000000000000000000000000;;	{% set base_metrics_cpu = "80m" -%}
0000000000000000000000000000000000000000;;	{% set metrics_cpu_per_node = 0.5 -%}
0000000000000000000000000000000000000000;;	{% set num_nodes = pillar.get('num_nodes', -1) -%}
0000000000000000000000000000000000000000;;	{% set nanny_memory = "90Mi" -%}
0000000000000000000000000000000000000000;;	{% set nanny_memory_per_node = 200 -%}
0000000000000000000000000000000000000000;;	{% if num_nodes >= 0 -%}
0000000000000000000000000000000000000000;;	  {% set nanny_memory = (90 * 1024 + num_nodes * nanny_memory_per_node)|string + "Ki" -%}
0000000000000000000000000000000000000000;;	{% endif -%}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	apiVersion: v1
0000000000000000000000000000000000000000;;	kind: ServiceAccount
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: heapster
0000000000000000000000000000000000000000;;	  namespace: kube-system
0000000000000000000000000000000000000000;;	  labels:
0000000000000000000000000000000000000000;;	    kubernetes.io/cluster-service: "true"
0000000000000000000000000000000000000000;;	    addonmanager.kubernetes.io/mode: Reconcile
0000000000000000000000000000000000000000;;	---
0000000000000000000000000000000000000000;;	apiVersion: extensions/v1beta1
0000000000000000000000000000000000000000;;	kind: Deployment
0000000000000000000000000000000000000000;;	metadata:
0000000000000000000000000000000000000000;;	  name: heapster-v1.4.0
0000000000000000000000000000000000000000;;	  namespace: kube-system
0000000000000000000000000000000000000000;;	  labels:
0000000000000000000000000000000000000000;;	    k8s-app: heapster
0000000000000000000000000000000000000000;;	    kubernetes.io/cluster-service: "true"
0000000000000000000000000000000000000000;;	    addonmanager.kubernetes.io/mode: Reconcile
0000000000000000000000000000000000000000;;	    version: v1.4.0
0000000000000000000000000000000000000000;;	spec:
0000000000000000000000000000000000000000;;	  replicas: 1
0000000000000000000000000000000000000000;;	  selector:
0000000000000000000000000000000000000000;;	    matchLabels:
0000000000000000000000000000000000000000;;	      k8s-app: heapster
0000000000000000000000000000000000000000;;	      version: v1.4.0
0000000000000000000000000000000000000000;;	  template:
0000000000000000000000000000000000000000;;	    metadata:
0000000000000000000000000000000000000000;;	      labels:
0000000000000000000000000000000000000000;;	        k8s-app: heapster
0000000000000000000000000000000000000000;;	        version: v1.4.0
0000000000000000000000000000000000000000;;	      annotations:
0000000000000000000000000000000000000000;;	        scheduler.alpha.kubernetes.io/critical-pod: ''
0000000000000000000000000000000000000000;;	    spec:
0000000000000000000000000000000000000000;;	      containers:
0000000000000000000000000000000000000000;;	        - image: gcr.io/google_containers/heapster-amd64:v1.4.0
0000000000000000000000000000000000000000;;	          name: heapster
0000000000000000000000000000000000000000;;	          livenessProbe:
0000000000000000000000000000000000000000;;	            httpGet:
0000000000000000000000000000000000000000;;	              path: /healthz
0000000000000000000000000000000000000000;;	              port: 8082
0000000000000000000000000000000000000000;;	              scheme: HTTP
0000000000000000000000000000000000000000;;	            initialDelaySeconds: 180
0000000000000000000000000000000000000000;;	            timeoutSeconds: 5
0000000000000000000000000000000000000000;;	          command:
0000000000000000000000000000000000000000;;	            - /heapster
0000000000000000000000000000000000000000;;	            - --source=kubernetes.summary_api:''
0000000000000000000000000000000000000000;;	        - image: gcr.io/google_containers/addon-resizer:2.0
0000000000000000000000000000000000000000;;	          name: heapster-nanny
0000000000000000000000000000000000000000;;	          resources:
0000000000000000000000000000000000000000;;	            limits:
0000000000000000000000000000000000000000;;	              cpu: 50m
0000000000000000000000000000000000000000;;	              memory: {{ nanny_memory }}
0000000000000000000000000000000000000000;;	            requests:
0000000000000000000000000000000000000000;;	              cpu: 50m
0000000000000000000000000000000000000000;;	              memory: {{ nanny_memory }}
0000000000000000000000000000000000000000;;	          env:
0000000000000000000000000000000000000000;;	            - name: MY_POD_NAME
0000000000000000000000000000000000000000;;	              valueFrom:
0000000000000000000000000000000000000000;;	                fieldRef:
0000000000000000000000000000000000000000;;	                  fieldPath: metadata.name
0000000000000000000000000000000000000000;;	            - name: MY_POD_NAMESPACE
0000000000000000000000000000000000000000;;	              valueFrom:
0000000000000000000000000000000000000000;;	                fieldRef:
0000000000000000000000000000000000000000;;	                  fieldPath: metadata.namespace
0000000000000000000000000000000000000000;;	          command:
0000000000000000000000000000000000000000;;	            - /pod_nanny
0000000000000000000000000000000000000000;;	            - --cpu={{ base_metrics_cpu }}
0000000000000000000000000000000000000000;;	            - --extra-cpu={{ metrics_cpu_per_node }}m
0000000000000000000000000000000000000000;;	            - --memory={{ base_metrics_memory }}
0000000000000000000000000000000000000000;;	            - --extra-memory={{ metrics_memory_per_node }}Mi
0000000000000000000000000000000000000000;;	            - --deployment=heapster-v1.4.0
0000000000000000000000000000000000000000;;	            - --container=heapster
0000000000000000000000000000000000000000;;	            - --poll-period=300000
0000000000000000000000000000000000000000;;	      serviceAccountName: heapster
0000000000000000000000000000000000000000;;	      tolerations:
0000000000000000000000000000000000000000;;	        - key: "CriticalAddonsOnly"
0000000000000000000000000000000000000000;;	          operator: "Exists"
