0000000000000000000000000000000000000000;;	package system
b515bda5eede841df021a5bfcc6c5c7c7a1e907e;;	
0000000000000000000000000000000000000000;;	import (
0000000000000000000000000000000000000000;;		"syscall"
0000000000000000000000000000000000000000;;		"unsafe"
0000000000000000000000000000000000000000;;	)
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	var (
0000000000000000000000000000000000000000;;		modkernel32 = syscall.NewLazyDLL("kernel32.dll")
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;		procGlobalMemoryStatusEx = modkernel32.NewProc("GlobalMemoryStatusEx")
0000000000000000000000000000000000000000;;	)
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// https://msdn.microsoft.com/en-us/library/windows/desktop/aa366589(v=vs.85).aspx
0000000000000000000000000000000000000000;;	// https://msdn.microsoft.com/en-us/library/windows/desktop/aa366770(v=vs.85).aspx
0000000000000000000000000000000000000000;;	type memorystatusex struct {
0000000000000000000000000000000000000000;;		dwLength                uint32
0000000000000000000000000000000000000000;;		dwMemoryLoad            uint32
0000000000000000000000000000000000000000;;		ullTotalPhys            uint64
0000000000000000000000000000000000000000;;		ullAvailPhys            uint64
0000000000000000000000000000000000000000;;		ullTotalPageFile        uint64
0000000000000000000000000000000000000000;;		ullAvailPageFile        uint64
0000000000000000000000000000000000000000;;		ullTotalVirtual         uint64
0000000000000000000000000000000000000000;;		ullAvailVirtual         uint64
0000000000000000000000000000000000000000;;		ullAvailExtendedVirtual uint64
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// ReadMemInfo retrieves memory statistics of the host system and returns a
0000000000000000000000000000000000000000;;	//  MemInfo type.
0000000000000000000000000000000000000000;;	func ReadMemInfo() (*MemInfo, error) {
0000000000000000000000000000000000000000;;		msi := &memorystatusex{
0000000000000000000000000000000000000000;;			dwLength: 64,
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		r1, _, _ := procGlobalMemoryStatusEx.Call(uintptr(unsafe.Pointer(msi)))
0000000000000000000000000000000000000000;;		if r1 == 0 {
0000000000000000000000000000000000000000;;			return &MemInfo{}, nil
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;		return &MemInfo{
0000000000000000000000000000000000000000;;			MemTotal:  int64(msi.ullTotalPhys),
0000000000000000000000000000000000000000;;			MemFree:   int64(msi.ullAvailPhys),
0000000000000000000000000000000000000000;;			SwapTotal: int64(msi.ullTotalPageFile),
0000000000000000000000000000000000000000;;			SwapFree:  int64(msi.ullAvailPageFile),
0000000000000000000000000000000000000000;;		}, nil
0000000000000000000000000000000000000000;;	}
