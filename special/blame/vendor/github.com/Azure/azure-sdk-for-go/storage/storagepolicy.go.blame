0000000000000000000000000000000000000000;;	package storage
91454efdcfe2d233cf3f75fc014b3bb9ac6e5ae7;;	
0000000000000000000000000000000000000000;;	import (
0000000000000000000000000000000000000000;;		"strings"
0000000000000000000000000000000000000000;;		"time"
0000000000000000000000000000000000000000;;	)
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// AccessPolicyDetailsXML has specifics about an access policy
0000000000000000000000000000000000000000;;	// annotated with XML details.
0000000000000000000000000000000000000000;;	type AccessPolicyDetailsXML struct {
0000000000000000000000000000000000000000;;		StartTime  time.Time `xml:"Start"`
0000000000000000000000000000000000000000;;		ExpiryTime time.Time `xml:"Expiry"`
0000000000000000000000000000000000000000;;		Permission string    `xml:"Permission"`
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// SignedIdentifier is a wrapper for a specific policy
0000000000000000000000000000000000000000;;	type SignedIdentifier struct {
0000000000000000000000000000000000000000;;		ID           string                 `xml:"Id"`
0000000000000000000000000000000000000000;;		AccessPolicy AccessPolicyDetailsXML `xml:"AccessPolicy"`
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// SignedIdentifiers part of the response from GetPermissions call.
0000000000000000000000000000000000000000;;	type SignedIdentifiers struct {
0000000000000000000000000000000000000000;;		SignedIdentifiers []SignedIdentifier `xml:"SignedIdentifier"`
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// AccessPolicy is the response type from the GetPermissions call.
0000000000000000000000000000000000000000;;	type AccessPolicy struct {
0000000000000000000000000000000000000000;;		SignedIdentifiersList SignedIdentifiers `xml:"SignedIdentifiers"`
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	// convertAccessPolicyToXMLStructs converts between AccessPolicyDetails which is a struct better for API usage to the
0000000000000000000000000000000000000000;;	// AccessPolicy struct which will get converted to XML.
0000000000000000000000000000000000000000;;	func convertAccessPolicyToXMLStructs(id string, startTime time.Time, expiryTime time.Time, permissions string) SignedIdentifier {
0000000000000000000000000000000000000000;;		return SignedIdentifier{
0000000000000000000000000000000000000000;;			ID: id,
0000000000000000000000000000000000000000;;			AccessPolicy: AccessPolicyDetailsXML{
0000000000000000000000000000000000000000;;				StartTime:  startTime.UTC().Round(time.Second),
0000000000000000000000000000000000000000;;				ExpiryTime: expiryTime.UTC().Round(time.Second),
0000000000000000000000000000000000000000;;				Permission: permissions,
0000000000000000000000000000000000000000;;			},
0000000000000000000000000000000000000000;;		}
0000000000000000000000000000000000000000;;	}
0000000000000000000000000000000000000000;;	
0000000000000000000000000000000000000000;;	func updatePermissions(permissions, permission string) bool {
0000000000000000000000000000000000000000;;		return strings.Contains(permissions, permission)
0000000000000000000000000000000000000000;;	}
